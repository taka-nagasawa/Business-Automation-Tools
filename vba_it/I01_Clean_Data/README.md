# I01 顧客名寄せ

## 1. 実行前の重要設定（マクロ使用時の注意点）
インターネットからダウンロードしたファイルの場合、Excelを開く前に以下の設定を行わないとマクロが動作しません。

1. ダウンロードしたファイルを**右クリック**し、「プロパティ」を選択。
2. 「全般」タブの一番下にあるセキュリティ項目を確認。
3. **「許可する」**（または「ブロックを解除」）にチェックを入れ、OKを押す。

## 名寄せの仕組み（プロセス詳細）
このマクロは以下の3ステップで名前を確定させています。

### 1. 文字の掃除（クレンジング）
まず、元データを以下の優先順位で加工し、比較用の「社名データ」を作ります。
* **不要語の削除**: 「株式会社」「(株)」などの法人格、および全角・半角スペースをすべて消去。
* **文字種の統一**: 英数字とカタカナを「半角」に、アルファベットを「大文字」に統一。
    * 例：` 株式会社　Ｔｅｃｈ ` → `TECH`
    * 例：`（株）ﾃｯｸ ` → `ﾃｯｸ`
    * 
### 2. マスタとの照合
「社名データ」をキーにして、`master`シートのA列（ゆらぎ名）を上から検索します。
* **一致した場合**: その行のB列にある「正式名」を最終的な集計名として採用します。
* **一致しない場合**: 「社名データ」をそのまま集計名として採用します。

### 3. 集計
確定した名前が、すでに`summary`シートにあるか確認します。
* 既にある場合：その行の数量に加算。
* 無い場合：新しい行として名前と数量を追加。

