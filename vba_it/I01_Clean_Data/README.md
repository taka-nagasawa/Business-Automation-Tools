# I01 顧客名寄せ

## 1. 実行前の重要設定（マクロ使用時の注意点）
インターネットからダウンロードしたファイルの場合、Excelを開く前に以下の設定を行わないとマクロが動作しません。

1. ダウンロードしたファイルを**右クリック**し、**「プロパティ」**を選択。
2. 「全般」タブの一番下にあるセキュリティ項目を確認。
3. **「許可する」**（または「ブロックを解除」）にチェックを入れ、OKを押す。

## 2. 操作の配慮
* **実行環境**: `summary`シート等に設置済みの実行ボタンをクリックして動作させます。
* **事前の確認**: `data`, `master`, `summary` の各シート名が正確に設定されているか確認してください。

## 3. クレンジング動作
1. **Trim**：前後の余白削除。
2. **StrConv (vbNarrow)**：全角を半角へ変換。
3. **UCase**：英字の小文字をすべて大文字に統一。
4. **Replace**：半角/全角スペース、株式会社、(株)、（株）、㈱を一括削除。

## 4. マスタ照合の仕組み
* クレンジング後の名称で `master` シートA列を検索。
* 一致があればB列の「正式名」を取得。なければクレンジング後の名称をそのまま使用。
* **注意**: カタカナの「ッ」と「ツ」等の違いは、マスタに両方のパターンを登録して対応してください。

---

